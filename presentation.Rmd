---
title: "Laptop price predition"
author: "Group 42 <br> Shiyun Sun, Yunfei Gao, Yunxiang Gao, Zhenyu She, Haoran Jiang"
institute: "University of Edinburgh"    
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    lib_dir: libs
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      
---

```{r install-package, include = FALSE, eval = FALSE}
# Copy and paste the following code into your console to download and install
# the `xaringan` package that contains all of the code which allows you 
# to create presentation slides in Rmarkdown
install.packages('xaringan')
```


```{r load-packages, include = FALSE}
# Add any additional packages you need to this chunk
library(tidyverse)
library(tidymodels)
library(palmerpenguins)
library(knitr)
library(xaringanthemer)
```

```{r setup, include=FALSE}
# For better figure resolution
knitr::opts_chunk$set(fig.retina = 3, dpi = 300, fig.width = 6, fig.asp = 0.618, out.width = "80%")
```

```{r load-data, include=FALSE}
# Load your data here

```

```{r include=FALSE}

#Background image
style_xaringan(
  title_slide_background_image = "img/confetti.jpg"
)
```

class: center, middle

## Goal:Predit the price of a computer based on its configuration

---

class: inverse, center, middle

# Data pre-processing

---

# Data pre-processing
```{r pre-processing/1}
# PART1 >>> Data pre-processing
```

```{r pre-processing/2,echo=FALSE}
# PART1 >>> Data pre-processing
laptop_data_cleaned <- read_csv("laptop_data_cleaned.csv")
```

```{r pre-processing/3}
# Test the number of NA in data set
colSums(is.na(laptop_data_cleaned))
```
---

# Data pre-processing
```{r pre-processing-2, echo=FALSE}
# Keep the data for sum of HDD and SSD greater than 128
laptop_data_cleaned <- laptop_data_cleaned %>% 
  mutate(Storage_space = HDD+SSD)
laptop_data_cleaned <- filter(laptop_data_cleaned, Storage_space >= 128)
glimpse(laptop_data_cleaned)
```

---

class: inverse, center, middle

# Visualization

---

# Visualization
```{r 1, echo = FALSE, out.width = "80%", fig.align = "center"}
include_graphics("img/company.jpg")
```

---

# Visualization
```{r 2, echo = FALSE, out.width = "80%", fig.align = "center"}
include_graphics("img/typename.jpg")
```

---

# Visualization
```{r 3, echo = FALSE, out.width = "80%", fig.align = "center"}
include_graphics("img/ram.jpg")
```

---

# Visualization
```{r 4, echo = FALSE, out.width = "80%", fig.align = "center"}
include_graphics("img/weight.jpg")
```

---

# Visualization
```{r 5, echo = FALSE, out.width = "80%", fig.align = "center"}
include_graphics("img/touchscreen.jpg")
```

---

# Visualization
```{r 6, echo = FALSE, out.width = "80%", fig.align = "center"}
include_graphics("img/ips.jpg")
```

---

# Visualization
```{r 7, echo = FALSE, out.width = "80%", fig.align = "center"}
include_graphics("img/ppi.jpg")
```

---

# Visualization
```{r 8, echo = FALSE, out.width = "80%", fig.align = "center"}
include_graphics("img/cpu.jpg")
```

---

# Visualization
```{r 9, echo = FALSE, out.width = "80%", fig.align = "center"}
include_graphics("img/hdd.jpg")
```

---

# Visualization
```{r 10, echo = FALSE, out.width = "80%", fig.align = "center"}
include_graphics("img/gpu.jpg")
```

---

# Visualization
```{r 11, echo = FALSE, out.width = "80%", fig.align = "center"}
include_graphics("img/os.jpg")
```

---

class: inverse, middle, center
# Split data set and Cross-validation

---

class: inverse, middle, center

# Model building

---

# Initial model

```{r model}
set.seed(1365)
laptop_split <- initial_split(laptop_data_cleaned, prop = 0.80)
train_data <- training(laptop_split)
laptop_fit <- linear_reg() %>%
  set_engine("lm") %>%
  fit(Price ~ . - Storage_space, data = train_data)
tidy(laptop_fit)
```

---

# Initial model graph

```{r 12, echo = FALSE, out.width = "80%", fig.align = "center"}
include_graphics("img/initial.jpg")
```

---

# Final model

```{r model2}
laptop_fit_final <- linear_reg() %>%
  set_engine("lm") %>%
  fit(Price ~ .-HDD -Storage_space -Ips, data = train_data)
tidy(laptop_fit_final)
```

---

# Final model graph

```{r 13, echo = FALSE, out.width = "80%", fig.align = "center"}
include_graphics("img/final.jpg")
```

---

# Model test

```{r 14}
test <- c(glance(laptop_fit)$adj.r.squared,
  AIC(laptop_fit$fit),
  glance(laptop_fit_final)$adj.r.squared,
  AIC(laptop_fit_final$fit))
table <- matrix(test, nrow = 2, ncol = 2,
                       dimnames = list(test = c("R-square", "AIC"), 
                                       model = c("initial", "final")))
print(table)
```

---

#Reference
- Kushwaha, Gyan Prakash. “Laptop Price Prediction Cleaned Dataset.” Kaggle, 15 June 2023, www.kaggle.com/datasets/gyanprakashkushwaha/laptop-price-prediction-cleaned-dataset/data. 
